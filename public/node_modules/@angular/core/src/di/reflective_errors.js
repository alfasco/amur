
var __extends=(this&&this.__extends)||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};import{ListWrapper}from'../facade/collection';import{BaseError,WrappedError}from'../facade/errors';import{isBlank,stringify}from'../facade/lang';function findFirstClosedCycle(keys){var res=[];for(var i=0;i<keys.length;++i){if(ListWrapper.contains(res,keys[i])){res.push(keys[i]);return res;}
res.push(keys[i]);}
return res;}
function constructResolvingPath(keys){if(keys.length>1){var reversed=findFirstClosedCycle(ListWrapper.reversed(keys));var tokenStrs=reversed.map(function(k){return stringify(k.token);});return' ('+tokenStrs.join(' -> ')+')';}
return'';}
export var AbstractProviderError=(function(_super){__extends(AbstractProviderError,_super);function AbstractProviderError(injector,key,constructResolvingMessage){_super.call(this,'DI Error');this.keys=[key];this.injectors=[injector];this.constructResolvingMessage=constructResolvingMessage;this.message=this.constructResolvingMessage(this.keys);}
AbstractProviderError.prototype.addKey=function(injector,key){this.injectors.push(injector);this.keys.push(key);this.message=this.constructResolvingMessage(this.keys);};return AbstractProviderError;}(BaseError));export var NoProviderError=(function(_super){__extends(NoProviderError,_super);function NoProviderError(injector,key){_super.call(this,injector,key,function(keys){var first=stringify(ListWrapper.first(keys).token);return"No provider for "+first+"!"+constructResolvingPath(keys);});}
return NoProviderError;}(AbstractProviderError));export var CyclicDependencyError=(function(_super){__extends(CyclicDependencyError,_super);function CyclicDependencyError(injector,key){_super.call(this,injector,key,function(keys){return"Cannot instantiate cyclic dependency!"+constructResolvingPath(keys);});}
return CyclicDependencyError;}(AbstractProviderError));export var InstantiationError=(function(_super){__extends(InstantiationError,_super);function InstantiationError(injector,originalException,originalStack,key){_super.call(this,'DI Error',originalException);this.keys=[key];this.injectors=[injector];}
InstantiationError.prototype.addKey=function(injector,key){this.injectors.push(injector);this.keys.push(key);};Object.defineProperty(InstantiationError.prototype,"message",{get:function(){var first=stringify(ListWrapper.first(this.keys).token);return this.originalError.message+": Error during instantiation of "+first+"!"+constructResolvingPath(this.keys)+".";},enumerable:true,configurable:true});Object.defineProperty(InstantiationError.prototype,"causeKey",{get:function(){return this.keys[0];},enumerable:true,configurable:true});return InstantiationError;}(WrappedError));export var InvalidProviderError=(function(_super){__extends(InvalidProviderError,_super);function InvalidProviderError(provider){_super.call(this,"Invalid provider - only instances of Provider and Type are allowed, got: "+provider);}
return InvalidProviderError;}(BaseError));export var NoAnnotationError=(function(_super){__extends(NoAnnotationError,_super);function NoAnnotationError(typeOrFunc,params){_super.call(this,NoAnnotationError._genMessage(typeOrFunc,params));}
NoAnnotationError._genMessage=function(typeOrFunc,params){var signature=[];for(var i=0,ii=params.length;i<ii;i++){var parameter=params[i];if(isBlank(parameter)||parameter.length==0){signature.push('?');}
else{signature.push(parameter.map(stringify).join(' '));}}
return'Cannot resolve all parameters for \''+stringify(typeOrFunc)+'\'('+
signature.join(', ')+'). '+'Make sure that all the parameters are decorated with Inject or have valid type annotations and that \''+
stringify(typeOrFunc)+'\' is decorated with Injectable.';};return NoAnnotationError;}(BaseError));export var OutOfBoundsError=(function(_super){__extends(OutOfBoundsError,_super);function OutOfBoundsError(index){_super.call(this,"Index "+index+" is out-of-bounds.");}
return OutOfBoundsError;}(BaseError));export var MixingMultiProvidersWithRegularProvidersError=(function(_super){__extends(MixingMultiProvidersWithRegularProvidersError,_super);function MixingMultiProvidersWithRegularProvidersError(provider1,provider2){_super.call(this,'Cannot mix multi providers and regular providers, got: '+provider1.toString()+' '+
provider2.toString());}
return MixingMultiProvidersWithRegularProvidersError;}(BaseError));

import{getDebugNode}from'@angular/core';import{scheduleMicroTask}from'./facade/lang';export var ComponentFixture=(function(){function ComponentFixture(componentRef,ngZone,autoDetect){var _this=this;this._isStable=true;this._isDestroyed=false;this._promise=null;this._onUnstableSubscription=null;this._onStableSubscription=null;this._onMicrotaskEmptySubscription=null;this._onErrorSubscription=null;this.changeDetectorRef=componentRef.changeDetectorRef;this.elementRef=componentRef.location;this.debugElement=getDebugNode(this.elementRef.nativeElement);this.componentInstance=componentRef.instance;this.nativeElement=this.elementRef.nativeElement;this.componentRef=componentRef;this.ngZone=ngZone;this._autoDetect=autoDetect;if(ngZone!=null){this._onUnstableSubscription=ngZone.onUnstable.subscribe({next:function(){_this._isStable=false;}});this._onMicrotaskEmptySubscription=ngZone.onMicrotaskEmpty.subscribe({next:function(){if(_this._autoDetect){_this.detectChanges(true);}}});this._onStableSubscription=ngZone.onStable.subscribe({next:function(){_this._isStable=true;if(_this._promise!==null){scheduleMicroTask(function(){if(!_this.ngZone.hasPendingMacrotasks){if(_this._promise!==null){_this._resolve(true);_this._resolve=null;_this._promise=null;}}});}}});this._onErrorSubscription=ngZone.onError.subscribe({next:function(error){throw error;}});}}
ComponentFixture.prototype._tick=function(checkNoChanges){this.changeDetectorRef.detectChanges();if(checkNoChanges){this.checkNoChanges();}};ComponentFixture.prototype.detectChanges=function(checkNoChanges){var _this=this;if(checkNoChanges===void 0){checkNoChanges=true;}
if(this.ngZone!=null){this.ngZone.run(function(){_this._tick(checkNoChanges);});}
else{this._tick(checkNoChanges);}};ComponentFixture.prototype.checkNoChanges=function(){this.changeDetectorRef.checkNoChanges();};ComponentFixture.prototype.autoDetectChanges=function(autoDetect){if(autoDetect===void 0){autoDetect=true;}
if(this.ngZone==null){throw new Error('Cannot call autoDetectChanges when ComponentFixtureNoNgZone is set');}
this._autoDetect=autoDetect;this.detectChanges();};ComponentFixture.prototype.isStable=function(){return this._isStable&&!this.ngZone.hasPendingMacrotasks;};ComponentFixture.prototype.whenStable=function(){var _this=this;if(this.isStable()){return Promise.resolve(false);}
else if(this._promise!==null){return this._promise;}
else{this._promise=new Promise(function(res){_this._resolve=res;});return this._promise;}};ComponentFixture.prototype.destroy=function(){if(!this._isDestroyed){this.componentRef.destroy();if(this._onUnstableSubscription!=null){this._onUnstableSubscription.unsubscribe();this._onUnstableSubscription=null;}
if(this._onStableSubscription!=null){this._onStableSubscription.unsubscribe();this._onStableSubscription=null;}
if(this._onMicrotaskEmptySubscription!=null){this._onMicrotaskEmptySubscription.unsubscribe();this._onMicrotaskEmptySubscription=null;}
if(this._onErrorSubscription!=null){this._onErrorSubscription.unsubscribe();this._onErrorSubscription=null;}
this._isDestroyed=true;}};return ComponentFixture;}());
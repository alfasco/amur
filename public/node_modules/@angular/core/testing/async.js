
var _global=(typeof window==='undefined'?global:window);export function async(fn){if(_global.jasmine){return function(done){if(!done){done=function(){};done.fail=function(e){throw e;};}
runInTestZone(fn,done,function(err){if(typeof err==='string'){return done.fail(new Error(err));}
else{done.fail(err);}});};}
return function(){return new Promise(function(finishCallback,failCallback){runInTestZone(fn,finishCallback,failCallback);});};}
function runInTestZone(fn,finishCallback,failCallback){var currentZone=Zone.current;var AsyncTestZoneSpec=Zone['AsyncTestZoneSpec'];if(AsyncTestZoneSpec===undefined){throw new Error('AsyncTestZoneSpec is needed for the async() test helper but could not be found. '+'Please make sure that your environment includes zone.js/dist/async-test.js');}
var ProxyZoneSpec=Zone['ProxyZoneSpec'];if(ProxyZoneSpec===undefined){throw new Error('ProxyZoneSpec is needed for the async() test helper but could not be found. '+'Please make sure that your environment includes zone.js/dist/proxy.js');}
var proxyZoneSpec=ProxyZoneSpec.get();ProxyZoneSpec.assertPresent();var proxyZone=Zone.current.getZoneWith('ProxyZoneSpec');var previousDelegate=proxyZoneSpec.getDelegate();proxyZone.parent.run(function(){var testZoneSpec=new AsyncTestZoneSpec(function(){currentZone.run(function(){if(proxyZoneSpec.getDelegate()==testZoneSpec){proxyZoneSpec.setDelegate(previousDelegate);}
finishCallback();});},function(error){currentZone.run(function(){if(proxyZoneSpec.getDelegate()==testZoneSpec){proxyZoneSpec.setDelegate(previousDelegate);}
failCallback(error);});},'test');proxyZoneSpec.setDelegate(testZoneSpec);});return Zone.current.runGuarded(fn);}
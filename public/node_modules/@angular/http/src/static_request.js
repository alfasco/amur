
var __extends=(this&&this.__extends)||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};import{StringWrapper,isPresent}from'../src/facade/lang';import{Body}from'./body';import{ContentType}from'./enums';import{Headers}from'./headers';import{normalizeMethodName}from'./http_utils';import{URLSearchParams}from'./url_search_params';export var Request=(function(_super){__extends(Request,_super);function Request(requestOptions){_super.call(this);var url=requestOptions.url;this.url=requestOptions.url;if(isPresent(requestOptions.search)){var search=requestOptions.search.toString();if(search.length>0){var prefix='?';if(StringWrapper.contains(this.url,'?')){prefix=(this.url[this.url.length-1]=='&')?'':'&';}
this.url=url+prefix+search;}}
this._body=requestOptions.body;this.method=normalizeMethodName(requestOptions.method);this.headers=new Headers(requestOptions.headers);this.contentType=this.detectContentType();this.withCredentials=requestOptions.withCredentials;this.responseType=requestOptions.responseType;}
Request.prototype.detectContentType=function(){switch(this.headers.get('content-type')){case'application/json':return ContentType.JSON;case'application/x-www-form-urlencoded':return ContentType.FORM;case'multipart/form-data':return ContentType.FORM_DATA;case'text/plain':case'text/html':return ContentType.TEXT;case'application/octet-stream':return ContentType.BLOB;default:return this.detectContentTypeFromBody();}};Request.prototype.detectContentTypeFromBody=function(){if(this._body==null){return ContentType.NONE;}
else if(this._body instanceof URLSearchParams){return ContentType.FORM;}
else if(this._body instanceof FormData){return ContentType.FORM_DATA;}
else if(this._body instanceof Blob){return ContentType.BLOB;}
else if(this._body instanceof ArrayBuffer){return ContentType.ARRAY_BUFFER;}
else if(this._body&&typeof this._body=='object'){return ContentType.JSON;}
else{return ContentType.TEXT;}};Request.prototype.getBody=function(){switch(this.contentType){case ContentType.JSON:return this.text();case ContentType.FORM:return this.text();case ContentType.FORM_DATA:return this._body;case ContentType.TEXT:return this.text();case ContentType.BLOB:return this.blob();case ContentType.ARRAY_BUFFER:return this.arrayBuffer();default:return null;}};return Request;}(Body));var noop=function(){};var w=typeof window=='object'?window:noop;var FormData=w['FormData']||noop;var Blob=w['Blob']||noop;var ArrayBuffer=w['ArrayBuffer']||noop;
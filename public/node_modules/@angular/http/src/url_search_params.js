
import{ListWrapper,Map,isListLikeIterable}from'../src/facade/collection';import{isPresent}from'../src/facade/lang';function paramParser(rawParams){if(rawParams===void 0){rawParams='';}
var map=new Map();if(rawParams.length>0){var params=rawParams.split('&');params.forEach(function(param){var eqIdx=param.indexOf('=');var _a=eqIdx==-1?[param,'']:[param.slice(0,eqIdx),param.slice(eqIdx+1)],key=_a[0],val=_a[1];var list=map.get(key)||[];list.push(val);map.set(key,list);});}
return map;}
export var QueryEncoder=(function(){function QueryEncoder(){}
QueryEncoder.prototype.encodeKey=function(k){return standardEncoding(k);};QueryEncoder.prototype.encodeValue=function(v){return standardEncoding(v);};return QueryEncoder;}());function standardEncoding(v){return encodeURIComponent(v).replace(/%40/gi,'@').replace(/%3A/gi,':').replace(/%24/gi,'$').replace(/%2C/gi,',').replace(/%3B/gi,';').replace(/%2B/gi,'+').replace(/%3D/gi,'=').replace(/%3F/gi,'?').replace(/%2F/gi,'/');}
export var URLSearchParams=(function(){function URLSearchParams(rawParams,queryEncoder){if(rawParams===void 0){rawParams='';}
if(queryEncoder===void 0){queryEncoder=new QueryEncoder();}
this.rawParams=rawParams;this.queryEncoder=queryEncoder;this.paramsMap=paramParser(rawParams);}
URLSearchParams.prototype.clone=function(){var clone=new URLSearchParams('',this.queryEncoder);clone.appendAll(this);return clone;};URLSearchParams.prototype.has=function(param){return this.paramsMap.has(param);};URLSearchParams.prototype.get=function(param){var storedParam=this.paramsMap.get(param);if(isListLikeIterable(storedParam)){return ListWrapper.first(storedParam);}
else{return null;}};URLSearchParams.prototype.getAll=function(param){var mapParam=this.paramsMap.get(param);return isPresent(mapParam)?mapParam:[];};URLSearchParams.prototype.set=function(param,val){var mapParam=this.paramsMap.get(param);var list=isPresent(mapParam)?mapParam:[];ListWrapper.clear(list);list.push(val);this.paramsMap.set(param,list);};URLSearchParams.prototype.setAll=function(searchParams){var _this=this;searchParams.paramsMap.forEach(function(value,param){var mapParam=_this.paramsMap.get(param);var list=isPresent(mapParam)?mapParam:[];ListWrapper.clear(list);list.push(value[0]);_this.paramsMap.set(param,list);});};URLSearchParams.prototype.append=function(param,val){var mapParam=this.paramsMap.get(param);var list=isPresent(mapParam)?mapParam:[];list.push(val);this.paramsMap.set(param,list);};URLSearchParams.prototype.appendAll=function(searchParams){var _this=this;searchParams.paramsMap.forEach(function(value,param){var mapParam=_this.paramsMap.get(param);var list=isPresent(mapParam)?mapParam:[];for(var i=0;i<value.length;++i){list.push(value[i]);}
_this.paramsMap.set(param,list);});};URLSearchParams.prototype.replaceAll=function(searchParams){var _this=this;searchParams.paramsMap.forEach(function(value,param){var mapParam=_this.paramsMap.get(param);var list=isPresent(mapParam)?mapParam:[];ListWrapper.clear(list);for(var i=0;i<value.length;++i){list.push(value[i]);}
_this.paramsMap.set(param,list);});};URLSearchParams.prototype.toString=function(){var _this=this;var paramsList=[];this.paramsMap.forEach(function(values,k){values.forEach(function(v){return paramsList.push(_this.queryEncoder.encodeKey(k)+'='+_this.queryEncoder.encodeValue(v));});});return paramsList.join('&');};URLSearchParams.prototype.delete=function(param){this.paramsMap.delete(param);};return URLSearchParams;}());